# Arkime Configuration File
# https://arkime.com/settings

[default]

# OpenSearch connection
elasticsearch=${OPENSEARCH_URL}
elasticsearchBasicAuth=${OPENSEARCH_USER}:${OPENSEARCH_PASSWORD}
elasticsearch-insecure=true

# Packet capture settings
interface=${ARKIME_INTERFACE}
pcapDir=/data/pcap
maxFileSizeG=12
maxFileTimeM=60
maxPacketsInQueue=200000

# Logging
logDir=/data/logs
logFileBaseName=capture.log
logEveryXPackets=100000

# Performance
packetThreads=2
magicMode=basic
pcapWriteMethod=simple
pcapWriteSize=262144

# Compression
compressES=true

# Geo IP (optional - requires GeoIP databases)
# geoLite2Country=/data/GeoLite2-Country.mmdb
# geoLite2ASN=/data/GeoLite2-ASN.mmdb

# Metadata
node=thunderx-arkime
cluster=thunderx

# Viewer settings
viewer-port=8005
viewer-passwordSecret=${ARKIME_ADMIN_PASSWORD}
viewer-cert=/data/config/cert.pem
viewer-key=/data/config/key.pem

# Session timeout
sessionTimeout=3600

# Moloch/Arkime indices
prefix=arkime_

# Rotate indices
rotateIndex=daily

# SPI data
spiDataMaxIndices=4

# Delete after (days)
# daysToKeepDataDelete=7

# PCAP Delete
# Leave blank to never delete PCAP files
freeSpaceG=100

# Plugins directory
pluginsDir=/opt/arkime/plugins

# Rules directory
rulesDir=/data/config/rules

# OpenSearch/Elasticsearch tuning
dbBulkSize=300
dbFlushTimeout=5

# Reassembly
maxStreams=1000000
maxPackets=10000

# TCP timeout
tcpTimeout=600

# UDP timeout  
udpTimeout=30

# ICMP timeout
icmpTimeout=10

# Segment timeout
maxReqBody=256

# User settings
userNameHeader=
userAuthIps=

# Cert common name header
certCommonNameHeader=

# S2S (sensor to sensor) settings
# s2sServer=
# s2sPort=

# Right click menus
# rightClick=

# Header Authentication
# headerAuthURL=
# headerAuthCreateMode=

# LDAP Authentication  
# ldapURL=
# ldapBaseDN=

# Password hash algorithm
passwordHashCost=12
